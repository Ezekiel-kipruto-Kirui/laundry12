{% extends "base.html" %}
{% load static %}

{% block title %}Select Shop - Clean Page Laundry{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8">
        <div>
            <div class="mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-blue-100">
                <img src="{% static 'logos/Clean-page-logo.png' %}" alt="Logo" class="h-16 w-16 rounded-full">
            </div>
            <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
                Select Your Shop
            </h2>
            <p class="mt-2 text-center text-sm text-gray-600">
                Welcome back, {{ user.email }}! Please select the shop you want to access.
            </p>
        </div>

        <form class="mt-8 space-y-6" method="post">
            {% csrf_token %}

            {% if messages %}
            {% for message in messages %}
            <div
                class="rounded-md {% if message.tags == 'error' %}bg-red-50 border-red-200{% else %}bg-green-50 border-green-200{% endif %} border p-4">
                <div class="flex">
                    <div class="flex-shrink-0">
                        {% if message.tags == 'error' %}
                        <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                                clip-rule="evenodd" />
                        </svg>
                        {% else %}
                        <svg class="h-5 w-5 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                clip-rule="evenodd" />
                        </svg>
                        {% endif %}
                    </div>
                    <div class="ml-3">
                        <p
                            class="text-sm font-medium {% if message.tags == 'error' %}text-red-800{% else %}text-green-800{% endif %}">
                            {{ message }}
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endif %}

            <div class="space-y-4">
                {% for shop in available_shops %}
                <div class="relative">
                    <input class="sr-only" id="shop-{{ shop.id }}" name="shop_id" type="radio" value="{{ shop.id }}"
                        required>
                    <label
                        class="relative flex cursor-pointer rounded-lg border bg-white p-4 shadow-sm focus:outline-none radio-label"
                        for="shop-{{ shop.id }}">
                        <span class="flex flex-1">
                            <span class="flex flex-col">
                                <span class="block text-sm font-medium text-gray-900">{{ shop.shoptype }}</span>
                                <span class="mt-1 flex items-center text-sm text-gray-500">
                                    {% if shop.shoptype == 'Hotel' %}
                                    Access hotel management system
                                    {% else %}
                                    Access laundry management system
                                    {% endif %}
                                </span>
                            </span>
                        </span>
                        <svg class="h-5 w-5 text-blue-600 opacity-0 radio-check" xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                clip-rule="evenodd" />
                        </svg>
                        <span class="pointer-events-none absolute -inset-px rounded-lg border-2 border-transparent"
                            aria-hidden="true"></span>
                    </label>
                </div>
                {% endfor %}
            </div>

            <div>
                <button type="submit"
                    class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Continue to Dashboard
                </button>
            </div>
        </form>
    </div>
</div>

<style>
    input:checked+.radio-label {
        border-color: #2563eb;
        border-width: 2px;
    }

    input:checked+.radio-label .radio-check {
        opacity: 1;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const radioLabels = document.querySelectorAll('.radio-label');
        radioLabels.forEach(label => {
            label.addEventListener('click', function () {
                // Remove any previously selected styles
                radioLabels.forEach(l => {
                    l.classList.remove('border-blue-500', 'ring-2', 'ring-blue-500');
                });
                // Add selected style to current label
                this.classList.add('border-blue-500', 'ring-2', 'ring-blue-500');
            });
        });
    });
</script>
{% endblock %}