{% extends "base.html" %}
{% load static %}

{% block title %}{% if object %}Edit{% else %}Create{% endif %} Expense - Expense Manager{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto px-4 py-8">
    <div class="bg-white shadow rounded-lg p-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">
            {% if object %}Edit{% else %}Create{% endif %} Expense Record
        </h2>

        <form method="post">
            {% csrf_token %}

            <div class="space-y-6">
                <!-- Shop Selection -->
                {% if is_superuser %}
                <div>
                    <label for="{{ form.shop.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Select Shop *
                    </label>
                    {{ form.shop }}
                    {% if form.shop.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ form.shop.errors.0 }}</p>
                    {% endif %}
                    <p class="text-gray-500 text-xs mt-1">Choose which shop this expense belongs to</p>
                </div>
                {% else %}
                {% if form.shop %}
                <input type="hidden" name="shop" value="{{ user_shop }}">
                <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <div class="flex items-center">
                        <svg class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                        <span class="font-medium text-blue-800">Expense will be recorded for: {{ user_shop }}</span>
                    </div>
                    <p class="text-blue-600 text-sm mt-1">As a staff member, expenses are automatically assigned to your
                        shop.</p>
                </div>
                {% endif %}
                {% endif %}

                <!-- Expense Category -->
                <div>
                    <label for="{{ form.field.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Expense Category *
                    </label>
                    {{ form.field }}
                    {% if form.field.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ form.field.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Amount -->
                <div>
                    <label for="{{ form.amount.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Amount (KSh) *
                    </label>
                    {{ form.amount }}
                    {% if form.amount.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ form.amount.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Date -->
                <div>
                    <label for="{{ form.date.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Date *
                    </label>
                    {{ form.date }}
                    {% if form.date.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ form.date.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Notes -->
                <div>
                    <label for="{{ form.notes.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Description / Notes
                    </label>
                    {{ form.notes }}
                    {% if form.notes.errors %}
                    <p class="text-red-500 text-xs mt-1">{{ form.notes.errors.0 }}</p>
                    {% endif %}
                </div>
            </div>

            <div class="flex gap-4 pt-6">
                <button type="submit"
                    class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition duration-200 flex items-center">
                    <svg class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    {% if object %}Update{% else %}Create{% endif %} Expense
                </button>
                <a href="{% url 'laundry:expense_list' %}"
                    class="bg-gray-300 text-gray-700 px-6 py-2 rounded-md hover:bg-gray-400 transition duration-200">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<style>
    select,
    input,
    textarea {
        width: 100%;
        padding: 0.5rem 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        background-color: white;
        transition: border-color 0.2s, box-shadow 0.2s;
    }

    select:focus,
    input:focus,
    textarea:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    select {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.5rem center;
        background-repeat: no-repeat;
        background-size: 1.5em 1.5em;
        padding-right: 2.5rem;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
    }
</style>
{% endblock %}